/* keysched.c
 * Graven Imagery 1996
 * v1.1 1996/10/25 20:49:48 EDT
 *
 * Written with Symantec's THINK (Lightspeed) C by Richard Outerbridge.
 * This code inspired by an idea from Peter Trei.
 *
 * THIS SOFTWARE PLACED IN THE PUBLIC DOMAIN BY THE AUTHOR
 * 1996/11/10 18:00:00 EST
 *
 * OBLIGATORY IMPORTANT DISCLAIMERS, WARNINGS AND RESTRICTIONS
 * ===========================================================
 *
 * [1] This software is provided "as is" without warranty of fitness for use
 * or suitability for any purpose, express or implied.  Use at your own risk
 * or not at all.  It does, however, "do" DES.  To check your implementation
 * compare against the validation triples at the end of des3port.c
 *
 * [2] This software is "freeware".  It may be freely used and distributed.
 * My copyright in this software has not been abandoned, and is hereby asserted.
 *
 * [3] Exporting encryption software may require an export licence or permit.
 * Consult the appropriate branch(es) of your federal government.
 *
 * Copyright (c) 1988,1989,1990,1991,1992,1996 by Richard Outerbridge.
 * (outer@interlog.com; CIS : [71755,204]) Graven Imagery, 1996.
 *
 * Modified 6-Dec-1997 by Mr. Tines for CTC, who notes that the Public Domain
 * declaration and copyright assertion above are not self consistent, to
 * standardise the unsigned types
 */

#include "des3_c.h"

struct keysched {
    short far_out[16];
    uint32_t fan_out[15];
};

static const struct keysched precomp[56] = {
    { 
        { /* 00 : 8000000000000000 */
            1, 3, 4, 7, 9, 10, 12, 17, 18, 20, 23, 25, 26, 30, -1, -1
        }
        , {
            0x00100000uL, 0x04000000uL, 0x00040000uL, 0x00010000uL, 0x10000000uL,
            0x00020000uL, 0x04000000uL, 0x02000000uL, 0x00100000uL, 0x10000000uL,
            0x08000000uL, 0x00020000uL, 0x08000000uL, 0x00010000uL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 01 : 4000000000000000 */
            1, 2, 4, 7, 8, 11, 12, 15, 16, 19, 22, 25, 26, 28, 31, -1
        }
        , {
            0x08000000uL, 0x20000000uL, 0x00080000uL, 0x01000000uL, 0x00010000uL,
            0x04000000uL, 0x00040000uL, 0x00010000uL, 0x02000000uL, 0x00080000uL,
            0x00200000uL, 0x02000000uL, 0x00100000uL, 0x10000000uL, 0x00200000uL         }
    }
    ,
    { 
        { /* 02 : 2000000000000000 */
            0, 5, 9, 10, 12, 15, 19, 20, 23, 24, 27, 30, -1, -1, -1, -1
        }
        , {
            0x00200000uL, 0x00040000uL, 0x00200000uL, 0x20000000uL, 0x00080000uL,
            0x01000000uL, 0x00100000uL, 0x01000000uL, 0x20000000uL, 0x02000000uL,
            0x00080000uL, 0x04000000uL, 0xFFFFFFFFuL, 0xFFFFFFFFuL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 03 : 1000000000000000 */
            0, 4, 7, 9, 11, 12, 15, 16, 18, 20, 25, 26, 29, 30, -1, -1
        }
        , {
            0x00000100uL, 0x00001000uL, 0x00000008uL, 0x00000100uL, 0x00000020uL,
            0x00000020uL, 0x00000010uL, 0x00002000uL, 0x00000008uL, 0x00000400uL,
            0x00000200uL, 0x00000800uL, 0x00000002uL, 0x00000004uL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 04 : 0800000000000000 */
            1, 3, 5, 7, 8, 11, 13, 16, 21, 22, 25, 26, 28, 30, -1, -1
        }
        , {
            0x00000800uL, 0x00000008uL, 0x00000100uL, 0x00000020uL, 0x00000020uL,
            0x00000010uL, 0x00001000uL, 0x00000400uL, 0x00000200uL, 0x00000800uL,
            0x00000002uL, 0x00000100uL, 0x00000001uL, 0x00001000uL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 05 : 0400000000000000 */
            3, 5, 9, 10, 13, 15, 17, 18, 20, 23, 24, 26, 29, 30, -1, -1
        }
        , {
            0x00000010uL, 0x00001000uL, 0x00000004uL, 0x00000002uL, 0x00000001uL,
            0x00002000uL, 0x00000002uL, 0x00000100uL, 0x00000001uL, 0x00000800uL,
            0x00000010uL, 0x00000200uL, 0x00000400uL, 0x00000020uL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 06 : 0200000000000000 */
            2, 5, 7, 8, 12, 15, 16, 18, 21, 24, 26, 28, 31, -1, -1, -1
        }
        , {
            0x00000002uL, 0x00000001uL, 0x00002000uL, 0x00000004uL, 0x00001000uL,
            0x00000008uL, 0x00000010uL, 0x00000200uL, 0x00000400uL, 0x00002000uL,
            0x00000008uL, 0x00000400uL, 0x00000004uL, 0xFFFFFFFFuL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 07 : 0080000000000000 */
            1, 2, 5, 6, 9, 12, 15, 17, 21, 22, 24, 27, 28, 31, -1, -1
        }
        , {
            0x04000000uL, 0x01000000uL, 0x20000000uL, 0x02000000uL, 0x00080000uL,
            0x00200000uL, 0x02000000uL, 0x00040000uL, 0x00200000uL, 0x20000000uL,
            0x00080000uL, 0x01000000uL, 0x00010000uL, 0x00100000uL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 08 : 0040000000000000 */
            0, 3, 4, 9, 10, 13, 14, 17, 18, 20, 25, 29, 31, -1, -1, -1
        }
        , {
            0x20000000uL, 0x00020000uL, 0x08000000uL, 0x00100000uL, 0x01000000uL,
            0x20000000uL, 0x02000000uL, 0x10000000uL, 0x00020000uL, 0x04000000uL,
            0x00040000uL, 0x00200000uL, 0x08000000uL, 0xFFFFFFFFuL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 09 : 0020000000000000 */
            3, 4, 6, 9, 11, 12, 16, 19, 20, 23, 25, 26, 28, 30, -1, -1
        }
        , {
            0x02000000uL, 0x00100000uL, 0x10000000uL, 0x08000000uL, 0x00020000uL,
            0x08000000uL, 0x00010000uL, 0x04000000uL, 0x00040000uL, 0x00010000uL,
            0x10000000uL, 0x00020000uL, 0x04000000uL, 0x00200000uL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 10 : 0010000000000000 */
            2, 5, 6, 8, 11, 14, 17, 21, 22, 25, 27, 28, 30, -1, -1, -1
        }
        , {
            0x00000001uL, 0x00000800uL, 0x00000010uL, 0x00000200uL, 0x00000400uL,
            0x00002000uL, 0x00001000uL, 0x00000004uL, 0x00000002uL, 0x00000001uL,
            0x00002000uL, 0x00000004uL, 0x00000100uL, 0xFFFFFFFFuL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 11 : 0008000000000000 */
            1, 2, 4, 7, 10, 12, 14, 17, 18, 21, 23, 24, 28, 31, -1, -1
        }
        , {
            0x00000008uL, 0x00000010uL, 0x00000200uL, 0x00000400uL, 0x00002000uL,
            0x00000008uL, 0x00000400uL, 0x00000004uL, 0x00000002uL, 0x00000001uL,
            0x00002000uL, 0x00000004uL, 0x00001000uL, 0x00000800uL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 12 : 0004000000000000 */
            1, 2, 4, 6, 11, 12, 15, 16, 20, 23, 25, 27, 28, -1, -1, -1
        }
        , {
            0x00000010uL, 0x00002000uL, 0x00000008uL, 0x00000400uL, 0x00000200uL,
            0x00000800uL, 0x00000002uL, 0x00000004uL, 0x00001000uL, 0x00000008uL,
            0x00000100uL, 0x00000020uL, 0x00000020uL, 0xFFFFFFFFuL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 13 : 0002000000000000 */
            0, 3, 4, 7, 8, 10, 13, 14, 17, 19, 20, 23, 25, 29, -1, -1
        }
        , {
            0x00000002uL, 0x00000200uL, 0x00000800uL, 0x00000002uL, 0x00000100uL,
            0x00000001uL, 0x00000800uL, 0x00000010uL, 0x00000100uL, 0x00000020uL,
            0x00000020uL, 0x00000010uL, 0x00001000uL, 0x00000004uL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 14 : 0000800000000000 */
            0, 2, 5, 7, 8, 10, 15, 16, 18, 21, 23, 24, 29, 31, -1, -1
        }
        , {
            0x01000000uL, 0x00040000uL, 0x00010000uL, 0x10000000uL, 0x00020000uL,
            0x04000000uL, 0x00040000uL, 0x00100000uL, 0x10000000uL, 0x08000000uL,
            0x00020000uL, 0x08000000uL, 0x00100000uL, 0x04000000uL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 15 : 0000400000000000 */
            1, 2, 5, 6, 9, 10, 13, 15, 17, 20, 23, 24, 26, 29, 30, -1
        }
        , {
            0x00020000uL, 0x00080000uL, 0x01000000uL, 0x00010000uL, 0x04000000uL,
            0x00040000uL, 0x00010000uL, 0x10000000uL, 0x00080000uL, 0x00200000uL,
            0x02000000uL, 0x00100000uL, 0x10000000uL, 0x08000000uL, 0x20000000uL         }
    }
    ,
    { 
        { /* 16 : 0000200000000000 */
            1, 3, 7, 8, 10, 13, 14, 17, 18, 21, 22, 25, 28, -1, -1, -1
        }
        , {
            0x02000000uL, 0x00040000uL, 0x00200000uL, 0x20000000uL, 0x00080000uL,
            0x01000000uL, 0x00010000uL, 0x00100000uL, 0x01000000uL, 0x20000000uL,
            0x02000000uL, 0x00080000uL, 0x00200000uL, 0xFFFFFFFFuL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 17 : 0000100000000000 */
            0, 2, 5, 7, 9, 10, 13, 15, 16, 18, 23, 24, 27, 28, -1, -1
        }
        , {
            0x00000001uL, 0x00001000uL, 0x00000008uL, 0x00000100uL, 0x00000020uL,
            0x00000020uL, 0x00000010uL, 0x00001000uL, 0x00000008uL, 0x00000400uL,
            0x00000200uL, 0x00000800uL, 0x00000002uL, 0x00000100uL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 18 : 0000080000000000 */
            0, 3, 5, 6, 9, 11, 15, 19, 20, 23, 24, 26, 29, 31, -1, -1
        }
        , {
            0x00000010uL, 0x00000100uL, 0x00000020uL, 0x00000020uL, 0x00000010uL,
            0x00001000uL, 0x00000004uL, 0x00000200uL, 0x00000800uL, 0x00000002uL,
            0x00000100uL, 0x00000001uL, 0x00000800uL, 0x00000008uL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 19 : 0000040000000000 */
            0, 3, 7, 8, 11, 13, 14, 16, 18, 21, 22, 24, 27, 31, -1, -1
        }
        , {
            0x00002000uL, 0x00001000uL, 0x00000004uL, 0x00000002uL, 0x00000001uL,
            0x00002000uL, 0x00000004uL, 0x00000100uL, 0x00000001uL, 0x00000800uL,
            0x00000010uL, 0x00000200uL, 0x00000400uL, 0x00000010uL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 20 : 0000020000000000 */
            1, 3, 5, 6, 10, 13, 15, 16, 19, 22, 24, 26, 30, -1, -1, -1
        }
        , {
            0x00000200uL, 0x00000001uL, 0x00002000uL, 0x00000004uL, 0x00001000uL,
            0x00000008uL, 0x00000100uL, 0x00000200uL, 0x00000400uL, 0x00002000uL,
            0x00000008uL, 0x00000400uL, 0x00000002uL, 0xFFFFFFFFuL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 21 : 0000008000000000 */
            0, 3, 4, 7, 10, 13, 14, 19, 20, 22, 25, 26, 29, 30, -1, -1
        }
        , {
            0x00040000uL, 0x20000000uL, 0x02000000uL, 0x00080000uL, 0x00200000uL,
            0x02000000uL, 0x00100000uL, 0x00200000uL, 0x20000000uL, 0x00080000uL,
            0x01000000uL, 0x00010000uL, 0x04000000uL, 0x01000000uL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 22 : 0000004000000000 */
            0, 2, 7, 8, 11, 12, 15, 16, 18, 23, 27, 28, 31, -1, -1, -1
        }
        , {
            0x00080000uL, 0x08000000uL, 0x00100000uL, 0x01000000uL, 0x20000000uL,
            0x02000000uL, 0x00080000uL, 0x00020000uL, 0x04000000uL, 0x00040000uL,
            0x00200000uL, 0x20000000uL, 0x00020000uL, 0xFFFFFFFFuL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 23 : 0000002000000000 */
            1, 2, 4, 7, 9, 10, 15, 17, 18, 21, 23, 24, 26, 31, -1, -1
        }
        , {
            0x00040000uL, 0x00100000uL, 0x10000000uL, 0x08000000uL, 0x00020000uL,
            0x08000000uL, 0x00100000uL, 0x04000000uL, 0x00040000uL, 0x00010000uL,
            0x10000000uL, 0x00020000uL, 0x04000000uL, 0x02000000uL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 24 : 0000001000000000 */
            0, 3, 4, 6, 9, 12, 14, 19, 20, 23, 25, 26, 30, -1, -1, -1
        }
        , {
            0x00001000uL, 0x00000800uL, 0x00000010uL, 0x00000200uL, 0x00000400uL,
            0x00002000uL, 0x00000008uL, 0x00000004uL, 0x00000002uL, 0x00000001uL,
            0x00002000uL, 0x00000004uL, 0x00000001uL, 0xFFFFFFFFuL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 25 : 0000000800000000 */
            1, 2, 5, 8, 10, 12, 16, 19, 21, 22, 26, 29, 30, -1, -1, -1
        }
        , {
            0x00000100uL, 0x00000200uL, 0x00000400uL, 0x00002000uL, 0x00000008uL,
            0x00000400uL, 0x00000002uL, 0x00000001uL, 0x00002000uL, 0x00000004uL,
            0x00001000uL, 0x00000008uL, 0x00000010uL, 0xFFFFFFFFuL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 26 : 0000000400000000 */
            1, 2, 4, 9, 10, 13, 14, 18, 21, 23, 25, 26, 29, 30, -1, -1
        }
        , {
            0x00001000uL, 0x00000008uL, 0x00000400uL, 0x00000200uL, 0x00000800uL,
            0x00000002uL, 0x00000100uL, 0x00001000uL, 0x00000008uL, 0x00000100uL,
            0x00000020uL, 0x00000020uL, 0x00000010uL, 0x00002000uL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 27 : 0000000200000000 */
            1, 2, 5, 6, 8, 11, 12, 14, 17, 18, 21, 23, 27, 28, 31, -1
        }
        , {
            0x00000001uL, 0x00000800uL, 0x00000002uL, 0x00000100uL, 0x00000001uL,
            0x00000800uL, 0x00000010uL, 0x00000200uL, 0x00000020uL, 0x00000020uL,
            0x00000010uL, 0x00001000uL, 0x00000004uL, 0x00000002uL, 0x00000200uL         }
    }
    ,
    { 
        { /* 28 : 0000000080000000 */
            1, 3, 5, 6, 8, 13, 16, 19, 21, 22, 27, 28, 30, -1, -1, -1
        }
        , {
            0x20000000uL, 0x00010000uL, 0x10000000uL, 0x00020000uL, 0x04000000uL,
            0x00040000uL, 0x10000000uL, 0x08000000uL, 0x00020000uL, 0x08000000uL,
            0x00100000uL, 0x01000000uL, 0x00040000uL, 0xFFFFFFFFuL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 29 : 0000000040000000 */
            0, 3, 4, 7, 8, 11, 13, 14, 18, 21, 22, 24, 27, 29, 30, -1
        }
        , {
            0x08000000uL, 0x01000000uL, 0x00010000uL, 0x04000000uL, 0x00040000uL,
            0x00010000uL, 0x10000000uL, 0x00020000uL, 0x00200000uL, 0x02000000uL,
            0x00100000uL, 0x10000000uL, 0x08000000uL, 0x00020000uL, 0x00080000uL         }
    }
    ,
    { 
        { /* 30 : 0000000020000000 */
            0, 5, 6, 8, 11, 12, 15, 16, 19, 20, 23, 26, 29, 31, -1, -1
        }
        , {
            0x00100000uL, 0x00200000uL, 0x20000000uL, 0x00080000uL, 0x01000000uL,
            0x00010000uL, 0x04000000uL, 0x01000000uL, 0x20000000uL, 0x02000000uL,
            0x00080000uL, 0x00200000uL, 0x02000000uL, 0x00040000uL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 31 : 0000000010000000 */
            1, 2, 4, 9, 13, 14, 17, 18, 23, 24, 27, 28, 31, -1, -1, -1
        }
        , {
            0x00080000uL, 0x00020000uL, 0x04000000uL, 0x00040000uL, 0x00200000uL,
            0x20000000uL, 0x00020000uL, 0x08000000uL, 0x00100000uL, 0x01000000uL,
            0x20000000uL, 0x02000000uL, 0x10000000uL, 0xFFFFFFFFuL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 32 : 0000000008000000 */
            0, 3, 4, 7, 9, 13, 14, 17, 18, 21, 22, 24, 27, 28, 31, -1
        }
        , {
            0x00000200uL, 0x00000020uL, 0x00000020uL, 0x00000010uL, 0x00001000uL,
            0x00000004uL, 0x00000002uL, 0x00000200uL, 0x00000800uL, 0x00000002uL,
            0x00000100uL, 0x00000001uL, 0x00000800uL, 0x00000010uL, 0x00000100uL         }
    }
    ,
    { 
        { /* 33 : 0000000004000000 */
            0, 5, 6, 9, 11, 12, 16, 19, 20, 22, 25, 28, 31, -1, -1, -1
        }
        , {
            0x00000008uL, 0x00000004uL, 0x00000002uL, 0x00000001uL, 0x00002000uL,
            0x00000004uL, 0x00000001uL, 0x00000800uL, 0x00000010uL, 0x00000200uL,
            0x00000400uL, 0x00002000uL, 0x00001000uL, 0xFFFFFFFFuL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 34 : 0000000002000000 */
            0, 3, 4, 8, 11, 13, 15, 17, 20, 22, 24, 29, 31, -1, -1, -1
        }
        , {
            0x00000800uL, 0x00002000uL, 0x00000004uL, 0x00001000uL, 0x00000008uL,
            0x00000100uL, 0x00000020uL, 0x00000400uL, 0x00002000uL, 0x00000008uL,
            0x00000400uL, 0x00000200uL, 0x00000001uL, 0xFFFFFFFFuL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 35 : 0000000000800000 */
            1, 2, 5, 8, 11, 12, 14, 17, 18, 20, 23, 24, 27, 28, 31, -1
        }
        , {
            0x00010000uL, 0x02000000uL, 0x00080000uL, 0x00200000uL, 0x02000000uL,
            0x00100000uL, 0x10000000uL, 0x00200000uL, 0x20000000uL, 0x00080000uL,
            0x01000000uL, 0x00010000uL, 0x04000000uL, 0x00040000uL, 0x20000000uL         }
    }
    ,
    { 
        { /* 36 : 0000000000400000 */
            1, 5, 6, 9, 10, 13, 16, 21, 25, 26, 28, 30, -1, -1, -1, -1
        }
        , {
            0x01000000uL, 0x00100000uL, 0x01000000uL, 0x20000000uL, 0x02000000uL,
            0x00080000uL, 0x04000000uL, 0x00040000uL, 0x00200000uL, 0x20000000uL,
            0x00080000uL, 0x08000000uL, 0xFFFFFFFFuL, 0xFFFFFFFFuL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 37 : 0000000000200000 */
            2, 5, 7, 8, 13, 14, 16, 19, 21, 22, 24, 29, 30, -1, -1, -1
        }
        , {
            0x10000000uL, 0x08000000uL, 0x00020000uL, 0x08000000uL, 0x00100000uL,
            0x01000000uL, 0x00040000uL, 0x00010000uL, 0x10000000uL, 0x00020000uL,
            0x04000000uL, 0x00040000uL, 0x00100000uL, 0xFFFFFFFFuL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 38 : 0000000000100000 */
            0, 4, 7, 8, 10, 13, 15, 16, 19, 20, 23, 24, 27, 29, 31, -1
        }
        , {
            0x00020000uL, 0x00200000uL, 0x02000000uL, 0x00100000uL, 0x10000000uL,
            0x08000000uL, 0x00020000uL, 0x00080000uL, 0x01000000uL, 0x00010000uL,
            0x04000000uL, 0x00040000uL, 0x00010000uL, 0x10000000uL, 0x00080000uL         }
    }
    ,
    { 
        { /* 39 : 0000000000080000 */
            1, 3, 6, 8, 10, 15, 17, 19, 20, 24, 27, 29, 30, -1, -1, -1
        }
        , {
            0x00000020uL, 0x00000400uL, 0x00002000uL, 0x00000008uL, 0x00000400uL,
            0x00000200uL, 0x00000001uL, 0x00002000uL, 0x00000004uL, 0x00001000uL,
            0x00000008uL, 0x00000100uL, 0x00000200uL, 0xFFFFFFFFuL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 40 : 0000000000040000 */
            2, 7, 8, 11, 12, 14, 16, 19, 21, 23, 24, 27, 29, 30, -1, -1
        }
        , {
            0x00000400uL, 0x00000200uL, 0x00000800uL, 0x00000002uL, 0x00000100uL,
            0x00000001uL, 0x00001000uL, 0x00000008uL, 0x00000100uL, 0x00000020uL,
            0x00000020uL, 0x00000010uL, 0x00001000uL, 0x00000008uL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 41 : 0000000000020000 */
            1, 3, 4, 6, 9, 10, 12, 15, 16, 19, 21, 25, 26, 29, 30, -1
        }
        , {
            0x00002000uL, 0x00000002uL, 0x00000100uL, 0x00000001uL, 0x00000800uL,
            0x00000010uL, 0x00000200uL, 0x00000400uL, 0x00000020uL, 0x00000010uL,
            0x00001000uL, 0x00000004uL, 0x00000002uL, 0x00000001uL, 0x00000800uL         }
    }
    ,
    { 
        { /* 42 : 0000000000008000 */
            0, 3, 4, 6, 11, 15, 17, 19, 20, 25, 26, 29, 31, -1, -1, -1
        }
        , {
            0x02000000uL, 0x10000000uL, 0x00020000uL, 0x04000000uL, 0x00040000uL,
            0x00200000uL, 0x08000000uL, 0x00020000uL, 0x08000000uL, 0x00100000uL,
            0x01000000uL, 0x20000000uL, 0x00010000uL, 0xFFFFFFFFuL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 43 : 0000000000004000 */
            2, 5, 6, 9, 11, 12, 14, 16, 19, 20, 22, 25, 27, 28, 31, -1
        }
        , {
            0x00010000uL, 0x04000000uL, 0x00040000uL, 0x00010000uL, 0x10000000uL,
            0x00020000uL, 0x04000000uL, 0x00200000uL, 0x02000000uL, 0x00100000uL,
            0x10000000uL, 0x08000000uL, 0x00020000uL, 0x08000000uL, 0x01000000uL         }
    }
    ,
    { 
        { /* 44 : 0000000000002000 */
            0, 3, 4, 6, 9, 10, 13, 14, 17, 18, 21, 24, 27, 28, -1, -1
        }
        , {
            0x10000000uL, 0x00200000uL, 0x20000000uL, 0x00080000uL, 0x01000000uL,
            0x00010000uL, 0x04000000uL, 0x00040000uL, 0x20000000uL, 0x02000000uL,
            0x00080000uL, 0x00200000uL, 0x02000000uL, 0x00100000uL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 45 : 0000000000001000 */
            2, 7, 11, 12, 14, 16, 21, 22, 25, 26, 29, 30, -1, -1, -1, -1
        }
        , {
            0x04000000uL, 0x00040000uL, 0x00200000uL, 0x20000000uL, 0x00080000uL,
            0x08000000uL, 0x00100000uL, 0x01000000uL, 0x20000000uL, 0x02000000uL,
            0x00080000uL, 0x00020000uL, 0xFFFFFFFFuL, 0xFFFFFFFFuL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 46 : 0000000000000800 */
            1, 2, 5, 7, 11, 12, 15, 16, 19, 20, 22, 25, 26, 28, 31, -1
        }
        , {
            0x00000400uL, 0x00000020uL, 0x00000010uL, 0x00001000uL, 0x00000004uL,
            0x00000002uL, 0x00000001uL, 0x00000800uL, 0x00000002uL, 0x00000100uL,
            0x00000001uL, 0x00000800uL, 0x00000010uL, 0x00000200uL, 0x00000020uL         }
    }
    ,
    { 
        { /* 47 : 0000000000000400 */
            0, 3, 4, 7, 9, 10, 14, 17, 18, 20, 23, 26, 28, -1, -1, -1
        }
        , {
            0x00000400uL, 0x00000004uL, 0x00000002uL, 0x00000001uL, 0x00002000uL,
            0x00000004uL, 0x00001000uL, 0x00000800uL, 0x00000010uL, 0x00000200uL,
            0x00000400uL, 0x00002000uL, 0x00000008uL, 0xFFFFFFFFuL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 48 : 0000000000000200 */
            1, 2, 6, 9, 11, 13, 14, 18, 20, 22, 27, 28, 31, -1, -1, -1
        }
        , {
            0x00000002uL, 0x00000004uL, 0x00001000uL, 0x00000008uL, 0x00000100uL,
            0x00000020uL, 0x00000020uL, 0x00002000uL, 0x00000008uL, 0x00000400uL,
            0x00000200uL, 0x00000800uL, 0x00002000uL, 0xFFFFFFFFuL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 49 : 0000000000000080 */
            1, 3, 6, 9, 10, 12, 15, 16, 18, 21, 22, 25, 26, 29, 30, -1
        }
        , {
            0x10000000uL, 0x00080000uL, 0x00200000uL, 0x02000000uL, 0x00100000uL,
            0x10000000uL, 0x08000000uL, 0x20000000uL, 0x00080000uL, 0x01000000uL,
            0x00010000uL, 0x04000000uL, 0x00040000uL, 0x00010000uL, 0x02000000uL         }
    }
    ,
    { 
        { /* 50 : 0000000000000040 */
            0, 3, 4, 7, 8, 11, 14, 19, 23, 24, 26, 29, -1, -1, -1, -1
        }
        , {
            0x00010000uL, 0x00100000uL, 0x01000000uL, 0x20000000uL, 0x02000000uL,
            0x00080000uL, 0x00200000uL, 0x00040000uL, 0x00200000uL, 0x20000000uL,
            0x00080000uL, 0x01000000uL, 0xFFFFFFFFuL, 0xFFFFFFFFuL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 51 : 0000000000000020 */
            1, 3, 5, 6, 11, 12, 15, 17, 19, 20, 22, 27, 30, -1, -1, -1
        }
        , {
            0x00200000uL, 0x08000000uL, 0x00020000uL, 0x08000000uL, 0x00100000uL,
            0x01000000uL, 0x20000000uL, 0x00010000uL, 0x10000000uL, 0x00020000uL,
            0x04000000uL, 0x00040000uL, 0x10000000uL, 0xFFFFFFFFuL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 52 : 0000000000000010 */
            0, 2, 5, 6, 8, 11, 13, 14, 17, 18, 21, 22, 25, 27, 28, -1
        }
        , {
            0x04000000uL, 0x00200000uL, 0x02000000uL, 0x00100000uL, 0x10000000uL,
            0x08000000uL, 0x00020000uL, 0x08000000uL, 0x01000000uL, 0x00010000uL,
            0x04000000uL, 0x00040000uL, 0x00010000uL, 0x10000000uL, 0x00020000uL         }
    }
    ,
    { 
        { /* 53 : 0000000000000008 */
            0, 4, 6, 8, 13, 14, 17, 18, 22, 25, 27, 29, 31, -1, -1, -1
        }
        , {
            0x00000020uL, 0x00002000uL, 0x00000008uL, 0x00000400uL, 0x00000200uL,
            0x00000800uL, 0x00002000uL, 0x00000004uL, 0x00001000uL, 0x00000008uL,
            0x00000100uL, 0x00000020uL, 0x00000400uL, 0xFFFFFFFFuL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 54 : 0000000000000004 */
            1, 5, 6, 9, 10, 12, 15, 17, 19, 21, 22, 25, 27, 30, -1, -1
        }
        , {
            0x00000004uL, 0x00000200uL, 0x00000800uL, 0x00000002uL, 0x00000100uL,
            0x00000001uL, 0x00000800uL, 0x00000008uL, 0x00000100uL, 0x00000020uL,
            0x00000020uL, 0x00000010uL, 0x00001000uL, 0x00000400uL, 0xFFFFFFFFuL         }
    }
    ,
    { 
        { /* 55 : 0000000000000002 */
            0, 2, 4, 7, 8, 10, 13, 17, 19, 23, 24, 27, 29, 31, -1, -1
        }
        , {
            0x00000004uL, 0x00000100uL, 0x00000001uL, 0x00000800uL, 0x00000010uL,
            0x00000200uL, 0x00000400uL, 0x00000010uL, 0x00001000uL, 0x00000004uL,
            0x00000002uL, 0x00000001uL, 0x00002000uL, 0x00000002uL, 0xFFFFFFFFuL         }
    }
};

/* const static unsigned short padding = 0x0123; // allignment */

void deskey( byte *hexkey, short mode, uint32_t *keybuf ) {
    const struct keysched *bitblit, *endbb;
    const uint32_t *bip;
    const short *kip;
    uint32_t *ccp, *dp, *ep, test;
    short idx;

    bitblit = precomp;
    endbb = bitblit + 56;

    ep = &keybuf[32];
    dp = keybuf;
    while( dp < ep ) *dp++ = 0uL;

    while( bitblit < endbb ) {
        test = (*hexkey++)&0xff;
        if( test & 0x80 ) {
            bip = bitblit->fan_out;
            kip = bitblit->far_out;
            while( (idx = *kip++) >= 0 ) keybuf[idx] |= *bip++;
        }
        bitblit++;
        if( test & 0x40 ) {
            bip = bitblit->fan_out;
            kip = bitblit->far_out;
            while( (idx = *kip++) >= 0 ) keybuf[idx] |= *bip++;
        }
        bitblit++;
        if( test & 0x20 ) {
            bip = bitblit->fan_out;
            kip = bitblit->far_out;
            while( (idx = *kip++) >= 0 ) keybuf[idx] |= *bip++;
        }
        bitblit++;
        if( test & 0x10 ) {
            bip = bitblit->fan_out;
            kip = bitblit->far_out;
            while( (idx = *kip++) >= 0 ) keybuf[idx] |= *bip++;
        }
        bitblit++;
        if( test & 0x08 ) {
            bip = bitblit->fan_out;
            kip = bitblit->far_out;
            while( (idx = *kip++) >= 0 ) keybuf[idx] |= *bip++;
        }
        bitblit++;
        if( test & 0x04 ) {
            bip = bitblit->fan_out;
            kip = bitblit->far_out;
            while( (idx = *kip++) >= 0 ) keybuf[idx] |= *bip++;
        }
        bitblit++;
        if( test & 0x02 ) {
            bip = bitblit->fan_out;
            kip = bitblit->far_out;
            while( (idx = *kip++) >= 0 ) keybuf[idx] |= *bip++;
        }
        bitblit++;
    }

    /* swap 0.1 with 30.31, 2.3 with 28.29, etc */
    if( mode == DE1 ) {
        ccp = keybuf;
        dp = &keybuf[30];
        ep = &keybuf[16];
        while( ccp < ep ) {
            test = *dp;
            *dp = *ccp;
            *ccp++ = test;
            test = dp[1];
            dp[1] = *ccp;
            *ccp++ = test;
            dp -= 2;
        }
    }

    return;
}

void des2key( byte *hexkey, short mode, uint32_t *keyout ) {
    uint32_t *cp, *ep, *dp;
    short revmod;

    revmod = (short)((mode == EN0) ? DE1 : EN0);
    deskey(&hexkey[8], revmod, &keyout[32]);
    deskey(hexkey, mode, keyout);
    cp = keyout;
    ep = &keyout[32];
    dp = &keyout[64];
    while( cp < ep ) *dp++ = *cp++;
    return;
}

void des3key( byte *hexkey, short mode, uint32_t *keyout ) {
    byte *first, *third;
    short revmod;

    if( mode == EN0 ) {
        revmod = DE1;
        first = hexkey;
        third = &hexkey[16];
    }
    else {
        revmod = EN0;
        first = &hexkey[16];
        third = hexkey;
    }
    deskey(first, mode, keyout);
    deskey(&hexkey[8], revmod, &keyout[32]);
    deskey(third, mode, &keyout[64]);
    return;
}

/* EOF keysched.c Graven Imagery */
